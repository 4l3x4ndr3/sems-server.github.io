<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>SEMS: _trans_layer Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">SEMS
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">_trans_layer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="_trans_layer" -->
<p><code>#include &lt;<a class="el" href="trans__layer_8h_source.html">trans_layer.h</a>&gt;</code></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><b>less_case_i</b></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#af7f59ae080ef1ee8f965c3b1cf08e32f">register_ua</a> (<a class="el" href="classsip__ua.html">sip_ua</a> *ua)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#ae63da0f6dbbac9c8ae945d7d2448204e">register_transport</a> (<a class="el" href="classtrsp__socket.html">trsp_socket</a> *trsp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#a90a6b9b3a79d975480a8b3e4440a7a83">clear_transports</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#a3f4f0fed7e8d2dd961f78e953f5413be">send_reply</a> (<a class="el" href="structsip__msg.html">sip_msg</a> *msg, const <a class="el" href="classtrans__ticket.html">trans_ticket</a> *tt, const <a class="el" href="structcstring.html">cstring</a> &amp;dialog_id, const <a class="el" href="structcstring.html">cstring</a> &amp;to_tag, <a class="el" href="classmsg__logger.html">msg_logger</a> *logger=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#a20806c005baf1478d5fab02f5079cad4">send_request</a> (<a class="el" href="structsip__msg.html">sip_msg</a> *msg, <a class="el" href="classtrans__ticket.html">trans_ticket</a> *tt, const <a class="el" href="structcstring.html">cstring</a> &amp;dialog_id, const <a class="el" href="structcstring.html">cstring</a> &amp;_next_hop, int out_interface=-1, unsigned int flags=0, <a class="el" href="classmsg__logger.html">msg_logger</a> *logger=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#a846904103e06582cb1fec3e96def1b11">cancel</a> (<a class="el" href="classtrans__ticket.html">trans_ticket</a> *tt, const <a class="el" href="structcstring.html">cstring</a> &amp;dialog_id, unsigned int inv_cseq, const <a class="el" href="structcstring.html">cstring</a> &amp;hdrs)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#a42c2e3eebadfea6d3a8ea8876a5f53cd">received_msg</a> (<a class="el" href="structsip__msg.html">sip_msg</a> *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#a1cdcd72d85b4d0a10e2c78ad8d2fa594">timer_expired</a> (<a class="el" href="classtrans__timer.html">trans_timer</a> *t, <a class="el" href="classtrans__bucket.html">trans_bucket</a> *bucket, <a class="el" href="classsip__trans.html">sip_trans</a> *tr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#a363dff21fac0cc13abee8614aae7340c">find_outbound_if</a> (sockaddr_storage *remote_ip)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#a15f1f0c5cd1ff4025c3bc677a9ab7acb">send_non_200_ack</a> (<a class="el" href="structsip__msg.html">sip_msg</a> *reply, <a class="el" href="classsip__trans.html">sip_trans</a> *t)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#a6589d8d345521ff571d4fd01b3140738">send_sl_reply</a> (<a class="el" href="structsip__msg.html">sip_msg</a> *req, int reply_code, const <a class="el" href="structcstring.html">cstring</a> &amp;reason, const <a class="el" href="structcstring.html">cstring</a> &amp;hdrs, const <a class="el" href="structcstring.html">cstring</a> &amp;body)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#ada00d6fd91056f8fb7ceecd7ac26046f">send_sf_error_reply</a> (const <a class="el" href="classtrans__ticket.html">trans_ticket</a> *tt, const <a class="el" href="structsip__msg.html">sip_msg</a> *req, int reply_code, const <a class="el" href="structcstring.html">cstring</a> &amp;reason, const <a class="el" href="structcstring.html">cstring</a> &amp;hdrs=<a class="el" href="structcstring.html">cstring</a>(), const <a class="el" href="structcstring.html">cstring</a> &amp;body=<a class="el" href="structcstring.html">cstring</a>())</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#ade82c78e59fb7b58530dd5842fe45e7c">transport_error</a> (<a class="el" href="structsip__msg.html">sip_msg</a> *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#a3e8171ff4e108aab5655a85f30cb1d12">timeout</a> (<a class="el" href="classtrans__bucket.html">trans_bucket</a> *bucket, <a class="el" href="classsip__trans.html">sip_trans</a> *t)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a961e67c68442f6512f3be273b8270108"></a><!-- doxytag: member="_trans_layer::get_stats" ref="a961e67c68442f6512f3be273b8270108" args="()" -->
const <a class="el" href="classtrans__stats.html">trans_stats</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>get_stats</b> ()</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#af15b7be7694f517f36d553f37e8a989b">accept_fr_without_totag</a> = false</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#afc4467d3341e6162292cd64d43f2bfdc">default_bl_ttl</a> = DEFAULT_BL_TTL</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#ad4b7845be2ba9bde85d5737f9e957fdb">set_next_hop</a> (<a class="el" href="structsip__msg.html">sip_msg</a> *msg, <a class="el" href="structcstring.html">cstring</a> *next_hop, unsigned short *next_port, <a class="el" href="structcstring.html">cstring</a> *next_trsp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#a3c677a945b3f8a6b92bf9825d318d8a7">set_trsp_socket</a> (<a class="el" href="structsip__msg.html">sip_msg</a> *msg, const <a class="el" href="structcstring.html">cstring</a> &amp;next_trsp, int out_interface)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9b49057a89e2de4925e3a185dcbb123b"></a><!-- doxytag: member="_trans_layer::copy_uac_trans" ref="a9b49057a89e2de4925e3a185dcbb123b" args="(sip_trans *tr)" -->
<a class="el" href="classsip__trans.html">sip_trans</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>copy_uac_trans</b> (<a class="el" href="classsip__trans.html">sip_trans</a> *tr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#ab03dd240e1b9dea3a278c51303740c64">try_next_ip</a> (<a class="el" href="classtrans__bucket.html">trans_bucket</a> *bucket, <a class="el" href="classsip__trans.html">sip_trans</a> *tr, bool use_new_trans)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#ac417cb7d2b09afa903cabc66a9b12cae">update_uac_reply</a> (<a class="el" href="classtrans__bucket.html">trans_bucket</a> *bucket, <a class="el" href="classsip__trans.html">sip_trans</a> *t, <a class="el" href="structsip__msg.html">sip_msg</a> *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aec545f1fbc56c31794cebfcde8f35e33"></a><!-- doxytag: member="_trans_layer::update_uac_request" ref="aec545f1fbc56c31794cebfcde8f35e33" args="(trans_bucket *bucket, sip_trans *&amp;t, sip_msg *msg)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>update_uac_request</b> (<a class="el" href="classtrans__bucket.html">trans_bucket</a> *bucket, <a class="el" href="classsip__trans.html">sip_trans</a> *&amp;t, <a class="el" href="structsip__msg.html">sip_msg</a> *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#ab4cc497e91c309cbe9fde54a55ae2a48">update_uas_request</a> (<a class="el" href="classtrans__bucket.html">trans_bucket</a> *bucket, <a class="el" href="classsip__trans.html">sip_trans</a> *t, <a class="el" href="structsip__msg.html">sip_msg</a> *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9f2bf5def7a8b48fcb754a15f46a1ad0"></a><!-- doxytag: member="_trans_layer::update_uas_reply" ref="a9f2bf5def7a8b48fcb754a15f46a1ad0" args="(trans_bucket *bucket, sip_trans *t, int reply_code)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>update_uas_reply</b> (<a class="el" href="classtrans__bucket.html">trans_bucket</a> *bucket, <a class="el" href="classsip__trans.html">sip_trans</a> *t, int reply_code)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#a0e45e853b0b1c8fe489c5209d867c18d">_trans_layer</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__trans__layer.html#a573e67d21982d188ce17c406e56b295a">process_rcvd_msg</a> (<a class="el" href="structsip__msg.html">sip_msg</a> *msg)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>The transaction layer object. Uses the singleton pattern. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a0e45e853b0b1c8fe489c5209d867c18d"></a><!-- doxytag: member="_trans_layer::_trans_layer" ref="a0e45e853b0b1c8fe489c5209d867c18d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class__trans__layer.html#a0e45e853b0b1c8fe489c5209d867c18d">_trans_layer::_trans_layer</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Avoid external instantiation. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="classsingleton.html">singleton</a>. </dd></dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a846904103e06582cb1fec3e96def1b11"></a><!-- doxytag: member="_trans_layer::cancel" ref="a846904103e06582cb1fec3e96def1b11" args="(trans_ticket *tt, const cstring &amp;dialog_id, unsigned int inv_cseq, const cstring &amp;hdrs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class__trans__layer.html#a846904103e06582cb1fec3e96def1b11">_trans_layer::cancel</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtrans__ticket.html">trans_ticket</a> *&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> &amp;&#160;</td>
          <td class="paramname"><em>dialog_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>inv_cseq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> &amp;&#160;</td>
          <td class="paramname"><em>hdrs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Cancels a request. A CANCEL request is sent if necessary. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">tt</td><td>transaction ticket from the original INVITE. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="classsip__trans.html#abd8145e65aebc3e3d8dc5f1be3e53132">sip_trans::canceled</a>, <a class="el" href="classsip__trans.html#aa9af6e78c670378d99f93c4e3e04b6b1">sip_trans::clear_timer()</a>, <a class="el" href="classtrsp__socket.html#ad6659e0300fa52095635bbaeaa2e68d0">trsp_socket::copy_addr_to()</a>, <a class="el" href="classsip__trans.html#a808c202168dc140589b1b82931de8add">sip_trans::dialog_id</a>, <a class="el" href="classht__bucket.html#aef0488b05ee06e4e02616871e96ca0f2">ht_bucket&lt; Value &gt;::exist()</a>, <a class="el" href="classsip__trans.html#a9b1378d1a8c4176690eeb5e78b3f9c49">sip_trans::flags</a>, <a class="el" href="classtrans__stats.html#a7f7e03703618c53662b3af7d607320f5">trans_stats::inc_sent_requests()</a>, <a class="el" href="classsip__trans.html#ad20fa74337f9d4c260145e5c5b854d29">sip_trans::logger</a>, <a class="el" href="classsip__trans.html#a5b902853272e9bd50e6974545259cbb3">sip_trans::msg</a>, and <a class="el" href="classsip__trans.html#afd799fcb7f405d1c63960d2e76da9588">sip_trans::state</a>.</p>

<p>Referenced by <a class="el" href="class__trans__layer.html#a1cdcd72d85b4d0a10e2c78ad8d2fa594">timer_expired()</a>, and <a class="el" href="class__trans__layer.html#ac417cb7d2b09afa903cabc66a9b12cae">update_uac_reply()</a>.</p>

</div>
</div>
<a class="anchor" id="a90a6b9b3a79d975480a8b3e4440a7a83"></a><!-- doxytag: member="_trans_layer::clear_transports" ref="a90a6b9b3a79d975480a8b3e4440a7a83" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class__trans__layer.html#a90a6b9b3a79d975480a8b3e4440a7a83">_trans_layer::clear_transports</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Clears all registered transport instances. </p>

</div>
</div>
<a class="anchor" id="a363dff21fac0cc13abee8614aae7340c"></a><!-- doxytag: member="_trans_layer::find_outbound_if" ref="a363dff21fac0cc13abee8614aae7340c" args="(sockaddr_storage *remote_ip)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class__trans__layer.html#a363dff21fac0cc13abee8614aae7340c">_trans_layer::find_outbound_if</a> </td>
          <td>(</td>
          <td class="paramtype">sockaddr_storage *&#160;</td>
          <td class="paramname"><em>remote_ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Tries to find an interface suitable for sending to the destination supplied. </p>

<p>Referenced by <a class="el" href="class__trans__layer.html#a3c677a945b3f8a6b92bf9825d318d8a7">set_trsp_socket()</a>.</p>

</div>
</div>
<a class="anchor" id="a573e67d21982d188ce17c406e56b295a"></a><!-- doxytag: member="_trans_layer::process_rcvd_msg" ref="a573e67d21982d188ce17c406e56b295a" args="(sip_msg *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class__trans__layer.html#a573e67d21982d188ce17c406e56b295a">_trans_layer::process_rcvd_msg</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsip__msg.html">sip_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Processes a parsed SIP message </p>

<p>References <a class="el" href="classsip__trans.html#a808c202168dc140589b1b82931de8add">sip_trans::dialog_id</a>, <a class="el" href="classtrans__stats.html#ab5f92e9b3dbc3b139d4bef8f138c492f">trans_stats::inc_received_replies()</a>, <a class="el" href="classtrans__stats.html#a016ef655823976bc426defe0541967ab">trans_stats::inc_received_requests()</a>, <a class="el" href="classsip__trans.html#ad20fa74337f9d4c260145e5c5b854d29">sip_trans::logger</a>, <a class="el" href="classsip__trans.html#a5b902853272e9bd50e6974545259cbb3">sip_trans::msg</a>, <a class="el" href="classsip__trans.html#a3e80a4881d2bf7955806a43741afe539">sip_trans::retransmit()</a>, <a class="el" href="class__trans__layer.html#a6589d8d345521ff571d4fd01b3140738">send_sl_reply()</a>, <a class="el" href="classsip__trans.html#afd799fcb7f405d1c63960d2e76da9588">sip_trans::state</a>, <a class="el" href="class__trans__layer.html#ac417cb7d2b09afa903cabc66a9b12cae">update_uac_reply()</a>, and <a class="el" href="class__trans__layer.html#ab4cc497e91c309cbe9fde54a55ae2a48">update_uas_request()</a>.</p>

<p>Referenced by <a class="el" href="class__trans__layer.html#a42c2e3eebadfea6d3a8ea8876a5f53cd">received_msg()</a>, and <a class="el" href="class__trans__layer.html#ade82c78e59fb7b58530dd5842fe45e7c">transport_error()</a>.</p>

</div>
</div>
<a class="anchor" id="a42c2e3eebadfea6d3a8ea8876a5f53cd"></a><!-- doxytag: member="_trans_layer::received_msg" ref="a42c2e3eebadfea6d3a8ea8876a5f53cd" args="(sip_msg *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class__trans__layer.html#a42c2e3eebadfea6d3a8ea8876a5f53cd">_trans_layer::received_msg</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsip__msg.html">sip_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Called by the transport layer when a new message has been recived. </p>

<p>References <a class="el" href="class__trans__layer.html#a573e67d21982d188ce17c406e56b295a">process_rcvd_msg()</a>, and <a class="el" href="class__trans__layer.html#a6589d8d345521ff571d4fd01b3140738">send_sl_reply()</a>.</p>

</div>
</div>
<a class="anchor" id="ae63da0f6dbbac9c8ae945d7d2448204e"></a><!-- doxytag: member="_trans_layer::register_transport" ref="ae63da0f6dbbac9c8ae945d7d2448204e" args="(trsp_socket *trsp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class__trans__layer.html#ae63da0f6dbbac9c8ae945d7d2448204e">_trans_layer::register_transport</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtrsp__socket.html">trsp_socket</a> *&#160;</td>
          <td class="paramname"><em>trsp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Register a transport instance. This method MUST be called at least once. </p>

<p>References <a class="el" href="classtrsp__socket.html#a1b6a3fc9991ecc5bc5451d8fb46ba217">trsp_socket::get_if()</a>, and <a class="el" href="classtrsp__socket.html#a47b61ccd37b297b6747899afdd4d7369">trsp_socket::get_transport()</a>.</p>

</div>
</div>
<a class="anchor" id="af7f59ae080ef1ee8f965c3b1cf08e32f"></a><!-- doxytag: member="_trans_layer::register_ua" ref="af7f59ae080ef1ee8f965c3b1cf08e32f" args="(sip_ua *ua)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class__trans__layer.html#af7f59ae080ef1ee8f965c3b1cf08e32f">_trans_layer::register_ua</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsip__ua.html">sip_ua</a> *&#160;</td>
          <td class="paramname"><em>ua</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Register a SIP UA. This method MUST be called ONCE. </p>

</div>
</div>
<a class="anchor" id="a15f1f0c5cd1ff4025c3bc677a9ab7acb"></a><!-- doxytag: member="_trans_layer::send_non_200_ack" ref="a15f1f0c5cd1ff4025c3bc677a9ab7acb" args="(sip_msg *reply, sip_trans *t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class__trans__layer.html#a15f1f0c5cd1ff4025c3bc677a9ab7acb">_trans_layer::send_non_200_ack</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsip__msg.html">sip_msg</a> *&#160;</td>
          <td class="paramname"><em>reply</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsip__trans.html">sip_trans</a> *&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Send ACK coresponding to error replies </p>

<p>References <a class="el" href="classtrsp__socket.html#ad6659e0300fa52095635bbaeaa2e68d0">trsp_socket::copy_addr_to()</a>, <a class="el" href="classsip__trans.html#a9b1378d1a8c4176690eeb5e78b3f9c49">sip_trans::flags</a>, <a class="el" href="classtrans__stats.html#a7f7e03703618c53662b3af7d607320f5">trans_stats::inc_sent_requests()</a>, <a class="el" href="classsip__trans.html#ad20fa74337f9d4c260145e5c5b854d29">sip_trans::logger</a>, <a class="el" href="classsip__trans.html#a5b902853272e9bd50e6974545259cbb3">sip_trans::msg</a>, and <a class="el" href="classtrsp__socket.html#a6b52fcda0983dafe61c71d420a269c40">trsp_socket::send()</a>.</p>

<p>Referenced by <a class="el" href="class__trans__layer.html#ac417cb7d2b09afa903cabc66a9b12cae">update_uac_reply()</a>.</p>

</div>
</div>
<a class="anchor" id="a3f4f0fed7e8d2dd961f78e953f5413be"></a><!-- doxytag: member="_trans_layer::send_reply" ref="a3f4f0fed7e8d2dd961f78e953f5413be" args="(sip_msg *msg, const trans_ticket *tt, const cstring &amp;dialog_id, const cstring &amp;to_tag, msg_logger *logger=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class__trans__layer.html#a3f4f0fed7e8d2dd961f78e953f5413be">_trans_layer::send_reply</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsip__msg.html">sip_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classtrans__ticket.html">trans_ticket</a> *&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> &amp;&#160;</td>
          <td class="paramname"><em>dialog_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> &amp;&#160;</td>
          <td class="paramname"><em>to_tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmsg__logger.html">msg_logger</a> *&#160;</td>
          <td class="paramname"><em>logger</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sends a UAS reply. If a body is included, the hdrs parameter should include a well-formed 'Content-Type', but no 'Content-Length' header. </p>

<p>References <a class="el" href="classtrsp__socket.html#ad6659e0300fa52095635bbaeaa2e68d0">trsp_socket::copy_addr_to()</a>, <a class="el" href="classsip__trans.html#a808c202168dc140589b1b82931de8add">sip_trans::dialog_id</a>, <a class="el" href="classht__bucket.html#aef0488b05ee06e4e02616871e96ca0f2">ht_bucket&lt; Value &gt;::exist()</a>, <a class="el" href="classht__bucket.html#ae8261014ea8752c07fdeb52a9a10fa8a">ht_bucket&lt; Value &gt;::get_id()</a>, <a class="el" href="classtrsp__socket.html#a47b61ccd37b297b6747899afdd4d7369">trsp_socket::get_transport()</a>, <a class="el" href="classtrans__stats.html#aff2cd88f9c79fc379c6e5b2ea2cd2cae">trans_stats::inc_sent_replies()</a>, <a class="el" href="AmUtils_8cpp.html#ac46bbc121c4737c1241555a6b7f0e05a">int2str()</a>, <a class="el" href="classtrsp__socket.html#acffdd89938786c3677e5c1f5b47bd571">trsp_socket::is_opt_set()</a>, <a class="el" href="classtrsp__socket.html#af0f84adb0458990f9ae6155d5e41afc4">trsp_socket::is_reliable()</a>, <a class="el" href="classsip__trans.html#acfc4bc4791f8e620f969460ac5f6b946">sip_trans::last_rseq</a>, <a class="el" href="classsip__trans.html#ad20fa74337f9d4c260145e5c5b854d29">sip_trans::logger</a>, <a class="el" href="classsip__trans.html#a5b902853272e9bd50e6974545259cbb3">sip_trans::msg</a>, <a class="el" href="classht__bucket.html#a7e3e23e83eed2000bb37fcf5c4b228ff">ht_bucket&lt; Value &gt;::remove()</a>, <a class="el" href="classsip__trans.html#a7797ea8d283a82ac05ec88b160d77bce">sip_trans::reply_status</a>, <a class="el" href="classsip__trans.html#a83124581d43b4a451bd2029cc7a1eb55">sip_trans::reset_timer()</a>, <a class="el" href="classsip__trans.html#a9e25ee72388b1179b2cce020ec2a9833">sip_trans::retr_addr</a>, <a class="el" href="classsip__trans.html#a44b180b61e29c9560f226e454b3bd40d">sip_trans::retr_buf</a>, <a class="el" href="classsip__trans.html#addf0e1073514fe8e4975521d370cf66f">sip_trans::retr_len</a>, <a class="el" href="classtrsp__socket.html#a6b52fcda0983dafe61c71d420a269c40">trsp_socket::send()</a>, and <a class="el" href="classsip__trans.html#a40f781b4dcfa6ec96534556c502ecfd7">sip_trans::to_tag</a>.</p>

<p>Referenced by <a class="el" href="class__trans__layer.html#ada00d6fd91056f8fb7ceecd7ac26046f">send_sf_error_reply()</a>.</p>

</div>
</div>
<a class="anchor" id="a20806c005baf1478d5fab02f5079cad4"></a><!-- doxytag: member="_trans_layer::send_request" ref="a20806c005baf1478d5fab02f5079cad4" args="(sip_msg *msg, trans_ticket *tt, const cstring &amp;dialog_id, const cstring &amp;_next_hop, int out_interface=&#45;1, unsigned int flags=0, msg_logger *logger=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class__trans__layer.html#a20806c005baf1478d5fab02f5079cad4">_trans_layer::send_request</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsip__msg.html">sip_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classtrans__ticket.html">trans_ticket</a> *&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> &amp;&#160;</td>
          <td class="paramname"><em>dialog_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> &amp;&#160;</td>
          <td class="paramname"><em>_next_hop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>out_interface</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmsg__logger.html">msg_logger</a> *&#160;</td>
          <td class="paramname"><em>logger</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sends a UAC request. Caution: Route headers should not be added to the general header list (msg-&gt;hdrs). </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>Pre-built message. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tt</td><td>transaction ticket (needed for replies &amp; CANCEL) </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="classtrsp__socket.html#ad6659e0300fa52095635bbaeaa2e68d0">trsp_socket::copy_addr_to()</a>, <a class="el" href="class__trans__layer.html#afc4467d3341e6162292cd64d43f2bfdc">default_bl_ttl</a>, <a class="el" href="classsip__trans.html#a808c202168dc140589b1b82931de8add">sip_trans::dialog_id</a>, <a class="el" href="classsip__trans.html#a9b1378d1a8c4176690eeb5e78b3f9c49">sip_trans::flags</a>, <a class="el" href="classht__bucket.html#ae8261014ea8752c07fdeb52a9a10fa8a">ht_bucket&lt; Value &gt;::get_id()</a>, <a class="el" href="classtrans__stats.html#a7f7e03703618c53662b3af7d607320f5">trans_stats::inc_sent_requests()</a>, <a class="el" href="classsip__trans.html#ad20fa74337f9d4c260145e5c5b854d29">sip_trans::logger</a>, <a class="el" href="classsip__trans.html#a5b902853272e9bd50e6974545259cbb3">sip_trans::msg</a>, <a class="el" href="classsip__trans.html#a83124581d43b4a451bd2029cc7a1eb55">sip_trans::reset_timer()</a>, <a class="el" href="classsip__trans.html#a44b180b61e29c9560f226e454b3bd40d">sip_trans::retr_buf</a>, <a class="el" href="classsip__trans.html#addf0e1073514fe8e4975521d370cf66f">sip_trans::retr_len</a>, <a class="el" href="class__trans__layer.html#ad4b7845be2ba9bde85d5737f9e957fdb">set_next_hop()</a>, <a class="el" href="class__trans__layer.html#a3c677a945b3f8a6b92bf9825d318d8a7">set_trsp_socket()</a>, and <a class="el" href="classsip__trans.html#aa9446b4af9778a024895fdb2d4fcd03d">sip_trans::targets</a>.</p>

</div>
</div>
<a class="anchor" id="ada00d6fd91056f8fb7ceecd7ac26046f"></a><!-- doxytag: member="_trans_layer::send_sf_error_reply" ref="ada00d6fd91056f8fb7ceecd7ac26046f" args="(const trans_ticket *tt, const sip_msg *req, int reply_code, const cstring &amp;reason, const cstring &amp;hdrs=cstring(), const cstring &amp;body=cstring())" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class__trans__layer.html#ada00d6fd91056f8fb7ceecd7ac26046f">_trans_layer::send_sf_error_reply</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classtrans__ticket.html">trans_ticket</a> *&#160;</td>
          <td class="paramname"><em>tt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structsip__msg.html">sip_msg</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reply_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> &amp;&#160;</td>
          <td class="paramname"><em>reason</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> &amp;&#160;</td>
          <td class="paramname"><em>hdrs</em> = <code><a class="el" href="structcstring.html">cstring</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> &amp;&#160;</td>
          <td class="paramname"><em>body</em> = <code><a class="el" href="structcstring.html">cstring</a>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sends a stateful error reply. If a body is included, the hdrs parameter should include a well-formed 'Content-Type', but no 'Content-Length' header. </p>

<p>References <a class="el" href="class__trans__layer.html#a3f4f0fed7e8d2dd961f78e953f5413be">send_reply()</a>.</p>

</div>
</div>
<a class="anchor" id="a6589d8d345521ff571d4fd01b3140738"></a><!-- doxytag: member="_trans_layer::send_sl_reply" ref="a6589d8d345521ff571d4fd01b3140738" args="(sip_msg *req, int reply_code, const cstring &amp;reason, const cstring &amp;hdrs, const cstring &amp;body)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class__trans__layer.html#a6589d8d345521ff571d4fd01b3140738">_trans_layer::send_sl_reply</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsip__msg.html">sip_msg</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reply_code</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> &amp;&#160;</td>
          <td class="paramname"><em>reason</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> &amp;&#160;</td>
          <td class="paramname"><em>hdrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> &amp;&#160;</td>
          <td class="paramname"><em>body</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sends a stateless reply. Useful for error replies. If a body is included, the hdrs parameter should include a well-formed 'Content-Type', but no 'Content-Length' header. </p>

<p>References <a class="el" href="classtrans__stats.html#aff2cd88f9c79fc379c6e5b2ea2cd2cae">trans_stats::inc_sent_replies()</a>, <a class="el" href="AmUtils_8cpp.html#ac46bbc121c4737c1241555a6b7f0e05a">int2str()</a>, and <a class="el" href="classtrsp__socket.html#a6b52fcda0983dafe61c71d420a269c40">trsp_socket::send()</a>.</p>

<p>Referenced by <a class="el" href="class__trans__layer.html#a573e67d21982d188ce17c406e56b295a">process_rcvd_msg()</a>, and <a class="el" href="class__trans__layer.html#a42c2e3eebadfea6d3a8ea8876a5f53cd">received_msg()</a>.</p>

</div>
</div>
<a class="anchor" id="ad4b7845be2ba9bde85d5737f9e957fdb"></a><!-- doxytag: member="_trans_layer::set_next_hop" ref="ad4b7845be2ba9bde85d5737f9e957fdb" args="(sip_msg *msg, cstring *next_hop, unsigned short *next_port, cstring *next_trsp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class__trans__layer.html#ad4b7845be2ba9bde85d5737f9e957fdb">_trans_layer::set_next_hop</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsip__msg.html">sip_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>next_hop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short *&#160;</td>
          <td class="paramname"><em>next_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcstring.html">cstring</a> *&#160;</td>
          <td class="paramname"><em>next_trsp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Fills the address structure passed and modifies R-URI and Route headers as needed. </p>

<p>Referenced by <a class="el" href="class__trans__layer.html#a20806c005baf1478d5fab02f5079cad4">send_request()</a>.</p>

</div>
</div>
<a class="anchor" id="a3c677a945b3f8a6b92bf9825d318d8a7"></a><!-- doxytag: member="_trans_layer::set_trsp_socket" ref="a3c677a945b3f8a6b92bf9825d318d8a7" args="(sip_msg *msg, const cstring &amp;next_trsp, int out_interface)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class__trans__layer.html#a3c677a945b3f8a6b92bf9825d318d8a7">_trans_layer::set_trsp_socket</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsip__msg.html">sip_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structcstring.html">cstring</a> &amp;&#160;</td>
          <td class="paramname"><em>next_trsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>out_interface</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Fills the local_socket attribute using the given transport and interface. If out_interface == -1, we will try hard to find an interface based on msg-&gt;remote_ip. </p>

<p>References <a class="el" href="class__trans__layer.html#a363dff21fac0cc13abee8614aae7340c">find_outbound_if()</a>.</p>

<p>Referenced by <a class="el" href="class__trans__layer.html#a20806c005baf1478d5fab02f5079cad4">send_request()</a>, and <a class="el" href="class__trans__layer.html#ab03dd240e1b9dea3a278c51303740c64">try_next_ip()</a>.</p>

</div>
</div>
<a class="anchor" id="a3e8171ff4e108aab5655a85f30cb1d12"></a><!-- doxytag: member="_trans_layer::timeout" ref="a3e8171ff4e108aab5655a85f30cb1d12" args="(trans_bucket *bucket, sip_trans *t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class__trans__layer.html#a3e8171ff4e108aab5655a85f30cb1d12">_trans_layer::timeout</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtrans__bucket.html">trans_bucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsip__trans.html">sip_trans</a> *&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Transaction timeout </p>

<p>References <a class="el" href="classsip__trans.html#a808c202168dc140589b1b82931de8add">sip_trans::dialog_id</a>, <a class="el" href="classsip__trans.html#a9b1378d1a8c4176690eeb5e78b3f9c49">sip_trans::flags</a>, <a class="el" href="classht__bucket.html#ae8261014ea8752c07fdeb52a9a10fa8a">ht_bucket&lt; Value &gt;::get_id()</a>, <a class="el" href="classsip__trans.html#a5b902853272e9bd50e6974545259cbb3">sip_trans::msg</a>, <a class="el" href="classht__bucket.html#a7e3e23e83eed2000bb37fcf5c4b228ff">ht_bucket&lt; Value &gt;::remove()</a>, <a class="el" href="classsip__trans.html#ad685d0425c12664ff9e2e7adf78483ec">sip_trans::reset_all_timers()</a>, <a class="el" href="classsip__trans.html#a83124581d43b4a451bd2029cc7a1eb55">sip_trans::reset_timer()</a>, and <a class="el" href="classsip__trans.html#afd799fcb7f405d1c63960d2e76da9588">sip_trans::state</a>.</p>

<p>Referenced by <a class="el" href="class__trans__layer.html#a1cdcd72d85b4d0a10e2c78ad8d2fa594">timer_expired()</a>.</p>

</div>
</div>
<a class="anchor" id="a1cdcd72d85b4d0a10e2c78ad8d2fa594"></a><!-- doxytag: member="_trans_layer::timer_expired" ref="a1cdcd72d85b4d0a10e2c78ad8d2fa594" args="(trans_timer *t, trans_bucket *bucket, sip_trans *tr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class__trans__layer.html#a1cdcd72d85b4d0a10e2c78ad8d2fa594">_trans_layer::timer_expired</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtrans__timer.html">trans_timer</a> *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classtrans__bucket.html">trans_bucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsip__trans.html">sip_trans</a> *&#160;</td>
          <td class="paramname"><em>tr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This is called by the transaction timer callback. At this place, the bucket is already locked, so please be quick. </p>

<p>References <a class="el" href="class__trans__layer.html#a846904103e06582cb1fec3e96def1b11">cancel()</a>, <a class="el" href="classsip__trans.html#aa9af6e78c670378d99f93c4e3e04b6b1">sip_trans::clear_timer()</a>, <a class="el" href="classtrsp__socket.html#ad6659e0300fa52095635bbaeaa2e68d0">trsp_socket::copy_addr_to()</a>, <a class="el" href="class__trans__layer.html#afc4467d3341e6162292cd64d43f2bfdc">default_bl_ttl</a>, <a class="el" href="classht__bucket.html#aef0488b05ee06e4e02616871e96ca0f2">ht_bucket&lt; Value &gt;::exist()</a>, <a class="el" href="classsip__trans.html#a9b1378d1a8c4176690eeb5e78b3f9c49">sip_trans::flags</a>, <a class="el" href="classht__bucket.html#ae8261014ea8752c07fdeb52a9a10fa8a">ht_bucket&lt; Value &gt;::get_id()</a>, <a class="el" href="classtrans__stats.html#a8448d77a7928f816e4f3691164282ae3">trans_stats::inc_sent_reply_retrans()</a>, <a class="el" href="classtrans__stats.html#aeda7d1aae6bac5fe691aff6b541d3952">trans_stats::inc_sent_request_retrans()</a>, <a class="el" href="classsip__trans.html#ad20fa74337f9d4c260145e5c5b854d29">sip_trans::logger</a>, <a class="el" href="classsip__trans.html#a5b902853272e9bd50e6974545259cbb3">sip_trans::msg</a>, <a class="el" href="classht__bucket.html#a7e3e23e83eed2000bb37fcf5c4b228ff">ht_bucket&lt; Value &gt;::remove()</a>, <a class="el" href="classsip__trans.html#a83124581d43b4a451bd2029cc7a1eb55">sip_trans::reset_timer()</a>, <a class="el" href="classsip__trans.html#addf0e1073514fe8e4975521d370cf66f">sip_trans::retr_len</a>, <a class="el" href="classsip__trans.html#a3e80a4881d2bf7955806a43741afe539">sip_trans::retransmit()</a>, <a class="el" href="classsip__trans.html#afd799fcb7f405d1c63960d2e76da9588">sip_trans::state</a>, <a class="el" href="class__trans__layer.html#a3e8171ff4e108aab5655a85f30cb1d12">timeout()</a>, <a class="el" href="class__trans__layer.html#ab03dd240e1b9dea3a278c51303740c64">try_next_ip()</a>, and <a class="el" href="classsip__trans.html#ae25f0940980bbed154cf9423e3f225e0">sip_trans::type</a>.</p>

</div>
</div>
<a class="anchor" id="ade82c78e59fb7b58530dd5842fe45e7c"></a><!-- doxytag: member="_trans_layer::transport_error" ref="ade82c78e59fb7b58530dd5842fe45e7c" args="(sip_msg *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class__trans__layer.html#ade82c78e59fb7b58530dd5842fe45e7c">_trans_layer::transport_error</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsip__msg.html">sip_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Allows the transport layer to signal an asynchronous error while sending out a SIP message. </p>

<p>References <a class="el" href="class__trans__layer.html#a573e67d21982d188ce17c406e56b295a">process_rcvd_msg()</a>.</p>

</div>
</div>
<a class="anchor" id="ab03dd240e1b9dea3a278c51303740c64"></a><!-- doxytag: member="_trans_layer::try_next_ip" ref="ab03dd240e1b9dea3a278c51303740c64" args="(trans_bucket *bucket, sip_trans *tr, bool use_new_trans)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class__trans__layer.html#ab03dd240e1b9dea3a278c51303740c64">_trans_layer::try_next_ip</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtrans__bucket.html">trans_bucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsip__trans.html">sip_trans</a> *&#160;</td>
          <td class="paramname"><em>tr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_new_trans</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If the destination has multiple IPs (SRV records), try the next destination IP. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if the message has been re-sent. -1 if no additional destination has been found. </dd></dl>

<p>References <a class="el" href="classsip__trans.html#aa9af6e78c670378d99f93c4e3e04b6b1">sip_trans::clear_timer()</a>, <a class="el" href="classtrsp__socket.html#ad6659e0300fa52095635bbaeaa2e68d0">trsp_socket::copy_addr_to()</a>, <a class="el" href="class__trans__layer.html#afc4467d3341e6162292cd64d43f2bfdc">default_bl_ttl</a>, <a class="el" href="classsip__trans.html#a9b1378d1a8c4176690eeb5e78b3f9c49">sip_trans::flags</a>, <a class="el" href="classht__bucket.html#ae8261014ea8752c07fdeb52a9a10fa8a">ht_bucket&lt; Value &gt;::get_id()</a>, <a class="el" href="classtrsp__socket.html#a1b6a3fc9991ecc5bc5451d8fb46ba217">trsp_socket::get_if()</a>, <a class="el" href="classsip__trans.html#ac1efa62b92018178f4984b1ea67c08fa">sip_trans::get_timer()</a>, <a class="el" href="classtrans__stats.html#a7f7e03703618c53662b3af7d607320f5">trans_stats::inc_sent_requests()</a>, <a class="el" href="classtrsp__socket.html#af0f84adb0458990f9ae6155d5e41afc4">trsp_socket::is_reliable()</a>, <a class="el" href="classsip__trans.html#ad20fa74337f9d4c260145e5c5b854d29">sip_trans::logger</a>, <a class="el" href="classsip__trans.html#a5b902853272e9bd50e6974545259cbb3">sip_trans::msg</a>, <a class="el" href="structsip__msg.html#a3b569e51f71c96960261d596c2da26aa">sip_msg::release()</a>, <a class="el" href="classsip__trans.html#a83124581d43b4a451bd2029cc7a1eb55">sip_trans::reset_timer()</a>, <a class="el" href="class__trans__layer.html#a3c677a945b3f8a6b92bf9825d318d8a7">set_trsp_socket()</a>, <a class="el" href="classsip__trans.html#afd799fcb7f405d1c63960d2e76da9588">sip_trans::state</a>, and <a class="el" href="classsip__trans.html#aa9446b4af9778a024895fdb2d4fcd03d">sip_trans::targets</a>.</p>

<p>Referenced by <a class="el" href="class__trans__layer.html#a1cdcd72d85b4d0a10e2c78ad8d2fa594">timer_expired()</a>, and <a class="el" href="class__trans__layer.html#ac417cb7d2b09afa903cabc66a9b12cae">update_uac_reply()</a>.</p>

</div>
</div>
<a class="anchor" id="ac417cb7d2b09afa903cabc66a9b12cae"></a><!-- doxytag: member="_trans_layer::update_uac_reply" ref="ac417cb7d2b09afa903cabc66a9b12cae" args="(trans_bucket *bucket, sip_trans *t, sip_msg *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class__trans__layer.html#ac417cb7d2b09afa903cabc66a9b12cae">_trans_layer::update_uac_reply</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtrans__bucket.html">trans_bucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsip__trans.html">sip_trans</a> *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsip__msg.html">sip_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Implements the state changes for the UAC state machine </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>-1 if errors </dd>
<dd>
transaction state if successfull </dd></dl>

<p>References <a class="el" href="class__trans__layer.html#a846904103e06582cb1fec3e96def1b11">cancel()</a>, <a class="el" href="classsip__trans.html#aa9af6e78c670378d99f93c4e3e04b6b1">sip_trans::clear_timer()</a>, <a class="el" href="class__trans__layer.html#afc4467d3341e6162292cd64d43f2bfdc">default_bl_ttl</a>, <a class="el" href="classsip__trans.html#a9b1378d1a8c4176690eeb5e78b3f9c49">sip_trans::flags</a>, <a class="el" href="classht__bucket.html#ae8261014ea8752c07fdeb52a9a10fa8a">ht_bucket&lt; Value &gt;::get_id()</a>, <a class="el" href="classtrsp__socket.html#af0f84adb0458990f9ae6155d5e41afc4">trsp_socket::is_reliable()</a>, <a class="el" href="classsip__trans.html#a5b902853272e9bd50e6974545259cbb3">sip_trans::msg</a>, <a class="el" href="classht__bucket.html#a7e3e23e83eed2000bb37fcf5c4b228ff">ht_bucket&lt; Value &gt;::remove()</a>, <a class="el" href="classsip__trans.html#ad685d0425c12664ff9e2e7adf78483ec">sip_trans::reset_all_timers()</a>, <a class="el" href="classsip__trans.html#a83124581d43b4a451bd2029cc7a1eb55">sip_trans::reset_timer()</a>, <a class="el" href="classsip__trans.html#a3e80a4881d2bf7955806a43741afe539">sip_trans::retransmit()</a>, <a class="el" href="class__trans__layer.html#a15f1f0c5cd1ff4025c3bc677a9ab7acb">send_non_200_ack()</a>, <a class="el" href="classsip__trans.html#afd799fcb7f405d1c63960d2e76da9588">sip_trans::state</a>, <a class="el" href="classsip__trans.html#a40f781b4dcfa6ec96534556c502ecfd7">sip_trans::to_tag</a>, and <a class="el" href="class__trans__layer.html#ab03dd240e1b9dea3a278c51303740c64">try_next_ip()</a>.</p>

<p>Referenced by <a class="el" href="class__trans__layer.html#a573e67d21982d188ce17c406e56b295a">process_rcvd_msg()</a>.</p>

</div>
</div>
<a class="anchor" id="ab4cc497e91c309cbe9fde54a55ae2a48"></a><!-- doxytag: member="_trans_layer::update_uas_request" ref="ab4cc497e91c309cbe9fde54a55ae2a48" args="(trans_bucket *bucket, sip_trans *t, sip_msg *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="class__trans__layer.html#ab4cc497e91c309cbe9fde54a55ae2a48">_trans_layer::update_uas_request</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classtrans__bucket.html">trans_bucket</a> *&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsip__trans.html">sip_trans</a> *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structsip__msg.html">sip_msg</a> *&#160;</td>
          <td class="paramname"><em>msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Implements the state changes for the UAS state machine </p>

<p>References <a class="el" href="classsip__trans.html#aa9af6e78c670378d99f93c4e3e04b6b1">sip_trans::clear_timer()</a>, <a class="el" href="classht__bucket.html#ae8261014ea8752c07fdeb52a9a10fa8a">ht_bucket&lt; Value &gt;::get_id()</a>, <a class="el" href="classtrsp__socket.html#af0f84adb0458990f9ae6155d5e41afc4">trsp_socket::is_reliable()</a>, <a class="el" href="classht__bucket.html#a7e3e23e83eed2000bb37fcf5c4b228ff">ht_bucket&lt; Value &gt;::remove()</a>, <a class="el" href="classsip__trans.html#a83124581d43b4a451bd2029cc7a1eb55">sip_trans::reset_timer()</a>, and <a class="el" href="classsip__trans.html#afd799fcb7f405d1c63960d2e76da9588">sip_trans::state</a>.</p>

<p>Referenced by <a class="el" href="class__trans__layer.html#a573e67d21982d188ce17c406e56b295a">process_rcvd_msg()</a>.</p>

</div>
</div>
<hr/><h2>Field Documentation</h2>
<a class="anchor" id="af15b7be7694f517f36d553f37e8a989b"></a><!-- doxytag: member="_trans_layer::accept_fr_without_totag" ref="af15b7be7694f517f36d553f37e8a989b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class__trans__layer.html#af15b7be7694f517f36d553f37e8a989b">_trans_layer::accept_fr_without_totag</a> = false<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Config option: if true, final replies without a to-tag will be accepted for requests which do not create a dialog. </p>

</div>
</div>
<a class="anchor" id="afc4467d3341e6162292cd64d43f2bfdc"></a><!-- doxytag: member="_trans_layer::default_bl_ttl" ref="afc4467d3341e6162292cd64d43f2bfdc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class__trans__layer.html#afc4467d3341e6162292cd64d43f2bfdc">_trans_layer::default_bl_ttl</a> = DEFAULT_BL_TTL<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Config option: default blacklist time-to-live </p>

<p>Referenced by <a class="el" href="class__trans__layer.html#a20806c005baf1478d5fab02f5079cad4">send_request()</a>, <a class="el" href="class__trans__layer.html#a1cdcd72d85b4d0a10e2c78ad8d2fa594">timer_expired()</a>, <a class="el" href="class__trans__layer.html#ab03dd240e1b9dea3a278c51303740c64">try_next_ip()</a>, and <a class="el" href="class__trans__layer.html#ac417cb7d2b09afa903cabc66a9b12cae">update_uac_reply()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="trans__layer_8h_source.html">trans_layer.h</a></li>
<li>trans_layer.cpp</li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
