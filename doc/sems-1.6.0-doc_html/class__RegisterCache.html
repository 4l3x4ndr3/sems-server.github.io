<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>SEMS: _RegisterCache Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">SEMS
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">_RegisterCache Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="_RegisterCache" --><!-- doxytag: inherits="AmThread" --><div class="dynheader">
Inheritance diagram for _RegisterCache:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class__RegisterCache.png" usemap="#_RegisterCache_map" alt=""/>
  <map id="_RegisterCache_map" name="_RegisterCache_map">
<area href="classAmThread.html" title="C++ Wrapper class for pthread." alt="AmThread" shape="rect" coords="0,0,102,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a86e4e2f92ad7fa6c64cc15a46364e689"></a><!-- doxytag: member="_RegisterCache::setStorageHandler" ref="a86e4e2f92ad7fa6c64cc15a46364e689" args="(RegCacheStorageHandler *h)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>setStorageHandler</b> (<a class="el" href="structRegCacheStorageHandler.html">RegCacheStorageHandler</a> *h)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__RegisterCache.html#a575ddf138de0fc6eb9261b0cdebabcfa">getAlias</a> (const string &amp;aor, const string &amp;uri, const string &amp;public_ip, <a class="el" href="structRegBinding.html">RegBinding</a> &amp;out_binding)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__RegisterCache.html#a68264485d27c5e92b09e117e2cac2955">update</a> (const string &amp;alias, long int reg_expires, const <a class="el" href="structAliasEntry.html">AliasEntry</a> &amp;alias_update)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2bb3d11b1d8467d0115eb6167e60ca5e"></a><!-- doxytag: member="_RegisterCache::update" ref="a2bb3d11b1d8467d0115eb6167e60ca5e" args="(long int reg_expires, const AliasEntry &amp;alias_update)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>update</b> (long int reg_expires, const <a class="el" href="structAliasEntry.html">AliasEntry</a> &amp;alias_update)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a902aacc64412f2d5c872e141d3454d64"></a><!-- doxytag: member="_RegisterCache::updateAliasExpires" ref="a902aacc64412f2d5c872e141d3454d64" args="(const string &amp;alias, long int ua_expires)" -->
bool&#160;</td><td class="memItemRight" valign="bottom"><b>updateAliasExpires</b> (const string &amp;alias, long int ua_expires)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__RegisterCache.html#a825281a0bf0db9bf4e6602a8260535bd">remove</a> (const string &amp;aor, const string &amp;uri, const string &amp;alias)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1f4a6f9d040bb4fb0f981ffb6753befc"></a><!-- doxytag: member="_RegisterCache::remove" ref="a1f4a6f9d040bb4fb0f981ffb6753befc" args="(const string &amp;aor)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>remove</b> (const string &amp;aor)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__RegisterCache.html#a9b890ee53f8eaff1326e6a2fa2f0d42d">getAorAliasMap</a> (const string &amp;aor, map&lt; string, string &gt; &amp;alias_map)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__RegisterCache.html#af96b572792fcdffe18c21da9a7e761d0">findAliasEntry</a> (const string &amp;alias, <a class="el" href="structAliasEntry.html">AliasEntry</a> &amp;alias_entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__RegisterCache.html#a712f87473adf6743e900b591155274d5">findAEByContact</a> (const string &amp;contact_uri, const string &amp;remote_ip, unsigned short remote_port, <a class="el" href="structAliasEntry.html">AliasEntry</a> &amp;ae)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__RegisterCache.html#af38091e478695429832cb3e08eba363d">throttleRegister</a> (<a class="el" href="structRegisterCacheCtx.html">RegisterCacheCtx</a> &amp;ctx, const <a class="el" href="classAmSipRequest.html">AmSipRequest</a> &amp;req, <a class="el" href="classmsg__logger.html">msg_logger</a> *logger=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__RegisterCache.html#a442afd251ba4bfb59ce36af5692a506f">saveSingleContact</a> (<a class="el" href="structRegisterCacheCtx.html">RegisterCacheCtx</a> &amp;ctx, const <a class="el" href="classAmSipRequest.html">AmSipRequest</a> &amp;req, <a class="el" href="classmsg__logger.html">msg_logger</a> *logger=NULL)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__RegisterCache.html#a3046d105221fd1a465030c38ef44d91f">getActiveRegs</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__RegisterCache.html#afc1020b06a4c84e061c7387594a328b8">canonicalize_aor</a> (const string &amp;aor)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab3865a9567119caa6d92b313ac698cf4"></a><!-- doxytag: member="_RegisterCache::compute_alias_hash" ref="ab3865a9567119caa6d92b313ac698cf4" args="(const string &amp;aor, const string &amp;contact_uri, const string &amp;public_ip)" -->
static string&#160;</td><td class="memItemRight" valign="bottom"><b>compute_alias_hash</b> (const string &amp;aor, const string &amp;contact_uri, const string &amp;public_ip)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af1d7aa77dbb251cd385b950b05eb62dd"></a><!-- doxytag: member="_RegisterCache::dispose" ref="af1d7aa77dbb251cd385b950b05eb62dd" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>dispose</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab0759ab75ab4d9f7e2a93b0b1543359d"></a><!-- doxytag: member="_RegisterCache::run" ref="ab0759ab75ab4d9f7e2a93b0b1543359d" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>run</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a411611054b249e26e2fe5cdd049b1457"></a><!-- doxytag: member="_RegisterCache::on_stop" ref="a411611054b249e26e2fe5cdd049b1457" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>on_stop</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAorBucket.html">AorBucket</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__RegisterCache.html#a4d84b66bbebf27967156a13cab16360a">getAorBucket</a> (const string &amp;aor)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAliasBucket.html">AliasBucket</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__RegisterCache.html#a8cb9a545c17afab026a0851511aac4ba">getAliasBucket</a> (const string &amp;alias)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classContactBucket.html">ContactBucket</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class__RegisterCache.html#a74d490a082e61e8d50f3ef0d6a9cf6d5">getContactBucket</a> (const string &amp;contact_uri, const string &amp;remote_ip, unsigned short remote_port)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af0d05da657c1c329deec68583b60441b"></a><!-- doxytag: member="_RegisterCache::parseAoR" ref="af0d05da657c1c329deec68583b60441b" args="(RegisterCacheCtx &amp;ctx, const AmSipRequest &amp;req, msg_logger *logger)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>parseAoR</b> (<a class="el" href="structRegisterCacheCtx.html">RegisterCacheCtx</a> &amp;ctx, const <a class="el" href="classAmSipRequest.html">AmSipRequest</a> &amp;req, <a class="el" href="classmsg__logger.html">msg_logger</a> *logger)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a551edf3b0600457204d9f27b0b3a8ea7"></a><!-- doxytag: member="_RegisterCache::parseContacts" ref="a551edf3b0600457204d9f27b0b3a8ea7" args="(RegisterCacheCtx &amp;ctx, const AmSipRequest &amp;req, msg_logger *logger)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>parseContacts</b> (<a class="el" href="structRegisterCacheCtx.html">RegisterCacheCtx</a> &amp;ctx, const <a class="el" href="classAmSipRequest.html">AmSipRequest</a> &amp;req, <a class="el" href="classmsg__logger.html">msg_logger</a> *logger)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5514c2b128f3dc68efc58dc27247510a"></a><!-- doxytag: member="_RegisterCache::parseExpires" ref="a5514c2b128f3dc68efc58dc27247510a" args="(RegisterCacheCtx &amp;ctx, const AmSipRequest &amp;req, msg_logger *logger)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>parseExpires</b> (<a class="el" href="structRegisterCacheCtx.html">RegisterCacheCtx</a> &amp;ctx, const <a class="el" href="classAmSipRequest.html">AmSipRequest</a> &amp;req, <a class="el" href="classmsg__logger.html">msg_logger</a> *logger)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac6fd73f993772f75a0302de4e57f9ebd"></a><!-- doxytag: member="_RegisterCache::setAliasUATimer" ref="ac6fd73f993772f75a0302de4e57f9ebd" args="(AliasEntry *alias_e)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>setAliasUATimer</b> (<a class="el" href="structAliasEntry.html">AliasEntry</a> *alias_e)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5c2d7e2766bfd659b7cd4d81bacdec6b"></a><!-- doxytag: member="_RegisterCache::removeAliasUATimer" ref="a5c2d7e2766bfd659b7cd4d81bacdec6b" args="(AliasEntry *alias_e)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>removeAliasUATimer</b> (<a class="el" href="structAliasEntry.html">AliasEntry</a> *alias_e)</td></tr>
</table>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="afc1020b06a4c84e061c7387594a328b8"></a><!-- doxytag: member="_RegisterCache::canonicalize_aor" ref="afc1020b06a4c84e061c7387594a328b8" args="(const string &amp;aor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="class__RegisterCache.html#afc1020b06a4c84e061c7387594a328b8">_RegisterCache::canonicalize_aor</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>uri</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>From RFC 3261 (Section 10.3, step 5): "all URI parameters MUST be removed (including the user-param), and
   any escaped characters MUST be converted to their unescaped form" </p>

</div>
</div>
<a class="anchor" id="a712f87473adf6743e900b591155274d5"></a><!-- doxytag: member="_RegisterCache::findAEByContact" ref="a712f87473adf6743e900b591155274d5" args="(const string &amp;contact_uri, const string &amp;remote_ip, unsigned short remote_port, AliasEntry &amp;ae)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class__RegisterCache.html#a712f87473adf6743e900b591155274d5">_RegisterCache::findAEByContact</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>contact_uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>remote_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>remote_port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structAliasEntry.html">AliasEntry</a> &amp;&#160;</td>
          <td class="paramname"><em>ae</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Retrieve the alias entry related to the given contact-URI, remote-IP &amp; port </p>

<p>References <a class="el" href="class__RegisterCache.html#af96b572792fcdffe18c21da9a7e761d0">findAliasEntry()</a>, and <a class="el" href="class__RegisterCache.html#a74d490a082e61e8d50f3ef0d6a9cf6d5">getContactBucket()</a>.</p>

</div>
</div>
<a class="anchor" id="af96b572792fcdffe18c21da9a7e761d0"></a><!-- doxytag: member="_RegisterCache::findAliasEntry" ref="af96b572792fcdffe18c21da9a7e761d0" args="(const string &amp;alias, AliasEntry &amp;alias_entry)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class__RegisterCache.html#af96b572792fcdffe18c21da9a7e761d0">_RegisterCache::findAliasEntry</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>alias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structAliasEntry.html">AliasEntry</a> &amp;&#160;</td>
          <td class="paramname"><em>alias_entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Retrieve the alias entry related to the given alias </p>

<p>References <a class="el" href="class__RegisterCache.html#a8cb9a545c17afab026a0851511aac4ba">getAliasBucket()</a>.</p>

<p>Referenced by <a class="el" href="class__RegisterCache.html#a712f87473adf6743e900b591155274d5">findAEByContact()</a>, <a class="el" href="class__RegisterCache.html#a9b890ee53f8eaff1326e6a2fa2f0d42d">getAorAliasMap()</a>, <a class="el" href="class__RegisterCache.html#a442afd251ba4bfb59ce36af5692a506f">saveSingleContact()</a>, and <a class="el" href="class__RegisterCache.html#af38091e478695429832cb3e08eba363d">throttleRegister()</a>.</p>

</div>
</div>
<a class="anchor" id="a3046d105221fd1a465030c38ef44d91f"></a><!-- doxytag: member="_RegisterCache::getActiveRegs" ref="a3046d105221fd1a465030c38ef44d91f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="class__RegisterCache.html#a3046d105221fd1a465030c38ef44d91f">_RegisterCache::getActiveRegs</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Statistics </p>

</div>
</div>
<a class="anchor" id="a575ddf138de0fc6eb9261b0cdebabcfa"></a><!-- doxytag: member="_RegisterCache::getAlias" ref="a575ddf138de0fc6eb9261b0cdebabcfa" args="(const string &amp;aor, const string &amp;uri, const string &amp;public_ip, RegBinding &amp;out_binding)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class__RegisterCache.html#a575ddf138de0fc6eb9261b0cdebabcfa">_RegisterCache::getAlias</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>aor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>public_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structRegBinding.html">RegBinding</a> &amp;&#160;</td>
          <td class="paramname"><em>out_binding</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Match, retrieve the contact cache entry associated with the URI passed, and return the alias found in the cache entry.</p>
<p>Note: this function locks and unlocks the contact cache bucket.</p>
<p>aor: canonical Address-of-Record uri: Contact-URI </p>

<p>References <a class="el" href="classAorBucket.html#a9c7bd72d52f65afd95ebb9e3e48d0e8c">AorBucket::get()</a>, and <a class="el" href="class__RegisterCache.html#a4d84b66bbebf27967156a13cab16360a">getAorBucket()</a>.</p>

<p>Referenced by <a class="el" href="class__RegisterCache.html#af38091e478695429832cb3e08eba363d">throttleRegister()</a>.</p>

</div>
</div>
<a class="anchor" id="a8cb9a545c17afab026a0851511aac4ba"></a><!-- doxytag: member="_RegisterCache::getAliasBucket" ref="a8cb9a545c17afab026a0851511aac4ba" args="(const string &amp;alias)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAliasBucket.html">AliasBucket</a> * <a class="el" href="class__RegisterCache.html#a8cb9a545c17afab026a0851511aac4ba">_RegisterCache::getAliasBucket</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>alias</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the bucket associated with the alias given alias: Contact-user </p>

<p>Referenced by <a class="el" href="class__RegisterCache.html#af96b572792fcdffe18c21da9a7e761d0">findAliasEntry()</a>, and <a class="el" href="class__RegisterCache.html#a68264485d27c5e92b09e117e2cac2955">update()</a>.</p>

</div>
</div>
<a class="anchor" id="a9b890ee53f8eaff1326e6a2fa2f0d42d"></a><!-- doxytag: member="_RegisterCache::getAorAliasMap" ref="a9b890ee53f8eaff1326e6a2fa2f0d42d" args="(const string &amp;aor, map&lt; string, string &gt; &amp;alias_map)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class__RegisterCache.html#a9b890ee53f8eaff1326e6a2fa2f0d42d">_RegisterCache::getAorAliasMap</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>aor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">map&lt; string, string &gt; &amp;&#160;</td>
          <td class="paramname"><em>alias_map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Retrieve an alias map containing all entries related to a particular AOR. This is needed to support REGISTER with '*' contact.</p>
<p>Note: this function locks and unlocks the contact cache bucket.</p>
<p>aor: canonical Address-of-Record alias_map: alias -&gt; contact </p>

<p>References <a class="el" href="class__RegisterCache.html#af96b572792fcdffe18c21da9a7e761d0">findAliasEntry()</a>, <a class="el" href="classAorBucket.html#a9c7bd72d52f65afd95ebb9e3e48d0e8c">AorBucket::get()</a>, and <a class="el" href="class__RegisterCache.html#a4d84b66bbebf27967156a13cab16360a">getAorBucket()</a>.</p>

<p>Referenced by <a class="el" href="class__RegisterCache.html#a442afd251ba4bfb59ce36af5692a506f">saveSingleContact()</a>.</p>

</div>
</div>
<a class="anchor" id="a4d84b66bbebf27967156a13cab16360a"></a><!-- doxytag: member="_RegisterCache::getAorBucket" ref="a4d84b66bbebf27967156a13cab16360a" args="(const string &amp;aor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAorBucket.html">AorBucket</a> * <a class="el" href="class__RegisterCache.html#a4d84b66bbebf27967156a13cab16360a">_RegisterCache::getAorBucket</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>aor</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the bucket associated with the passed contact-uri aor: canonicalized AOR </p>

<p>Referenced by <a class="el" href="class__RegisterCache.html#a575ddf138de0fc6eb9261b0cdebabcfa">getAlias()</a>, <a class="el" href="class__RegisterCache.html#a9b890ee53f8eaff1326e6a2fa2f0d42d">getAorAliasMap()</a>, <a class="el" href="class__RegisterCache.html#a825281a0bf0db9bf4e6602a8260535bd">remove()</a>, and <a class="el" href="class__RegisterCache.html#a68264485d27c5e92b09e117e2cac2955">update()</a>.</p>

</div>
</div>
<a class="anchor" id="a74d490a082e61e8d50f3ef0d6a9cf6d5"></a><!-- doxytag: member="_RegisterCache::getContactBucket" ref="a74d490a082e61e8d50f3ef0d6a9cf6d5" args="(const string &amp;contact_uri, const string &amp;remote_ip, unsigned short remote_port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classContactBucket.html">ContactBucket</a> * <a class="el" href="class__RegisterCache.html#a74d490a082e61e8d50f3ef0d6a9cf6d5">_RegisterCache::getContactBucket</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>contact_uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>remote_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>remote_port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the bucket associated with the contact-URI given </p>

<p>Referenced by <a class="el" href="class__RegisterCache.html#a712f87473adf6743e900b591155274d5">findAEByContact()</a>, and <a class="el" href="class__RegisterCache.html#a68264485d27c5e92b09e117e2cac2955">update()</a>.</p>

</div>
</div>
<a class="anchor" id="a825281a0bf0db9bf4e6602a8260535bd"></a><!-- doxytag: member="_RegisterCache::remove" ref="a825281a0bf0db9bf4e6602a8260535bd" args="(const string &amp;aor, const string &amp;uri, const string &amp;alias)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class__RegisterCache.html#a825281a0bf0db9bf4e6602a8260535bd">_RegisterCache::remove</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>aor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>alias</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Remove contact cache entry and alias map entries.</p>
<p>Note: this function locks and unlocks the contact cache bucket and the alias map bucket.</p>
<p>aor: canonical Address-of-Record uri: Contact-URI alias: </p>

<p>References <a class="el" href="classAorBucket.html#a9c7bd72d52f65afd95ebb9e3e48d0e8c">AorBucket::get()</a>, <a class="el" href="class__RegisterCache.html#a4d84b66bbebf27967156a13cab16360a">getAorBucket()</a>, and <a class="el" href="classht__map__bucket.html#ace2dd70bb4cca66aaae16ab251da351c">ht_map_bucket&lt; Key, Value, ElmtAlloc, ElmtCompare &gt;::remove()</a>.</p>

</div>
</div>
<a class="anchor" id="a442afd251ba4bfb59ce36af5692a506f"></a><!-- doxytag: member="_RegisterCache::saveSingleContact" ref="a442afd251ba4bfb59ce36af5692a506f" args="(RegisterCacheCtx &amp;ctx, const AmSipRequest &amp;req, msg_logger *logger=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class__RegisterCache.html#a442afd251ba4bfb59ce36af5692a506f">_RegisterCache::saveSingleContact</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRegisterCacheCtx.html">RegisterCacheCtx</a> &amp;&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAmSipRequest.html">AmSipRequest</a> &amp;&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmsg__logger.html">msg_logger</a> *&#160;</td>
          <td class="paramname"><em>logger</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Save a single REGISTER contact into cache</p>
<p>Returns false if failed:</p>
<ul>
<li>if request is not a REGISTER.</li>
<li>more than one contact should be (un)registered.</li>
</ul>
<p>If true has been returned, the request has already been replied with either an error or 200 (w/ contact).</p>
<p>Note: this function also handles binding query. (REGISTER w/o contacts) </p>

<p>References <a class="el" href="class__RegisterCache.html#af96b572792fcdffe18c21da9a7e761d0">findAliasEntry()</a>, <a class="el" href="class__RegisterCache.html#a9b890ee53f8eaff1326e6a2fa2f0d42d">getAorAliasMap()</a>, <a class="el" href="AmUtils_8cpp.html#ac46bbc121c4737c1241555a6b7f0e05a">int2str()</a>, <a class="el" href="classAmBasicSipDialog.html#a173299c62d08cbb0f02efe443eacebc1">AmBasicSipDialog::reply_error()</a>, <a class="el" href="AmUtils_8cpp.html#aef4ad5095b9be9be7b8e2f0e5f0779db">str2i()</a>, and <a class="el" href="class__RegisterCache.html#a68264485d27c5e92b09e117e2cac2955">update()</a>.</p>

</div>
</div>
<a class="anchor" id="af38091e478695429832cb3e08eba363d"></a><!-- doxytag: member="_RegisterCache::throttleRegister" ref="af38091e478695429832cb3e08eba363d" args="(RegisterCacheCtx &amp;ctx, const AmSipRequest &amp;req, msg_logger *logger=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class__RegisterCache.html#af38091e478695429832cb3e08eba363d">_RegisterCache::throttleRegister</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRegisterCacheCtx.html">RegisterCacheCtx</a> &amp;&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classAmSipRequest.html">AmSipRequest</a> &amp;&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmsg__logger.html">msg_logger</a> *&#160;</td>
          <td class="paramname"><em>logger</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Throttle REGISTER requests</p>
<p>Returns false if REGISTER should be forwarded:</p>
<ul>
<li>if registrar binding should be renewed.</li>
<li>if source IP or port do not match the saved IP &amp; port.</li>
<li>if the request unregisters any contact.</li>
<li>if request is not a REGISTER </li>
</ul>

<p>References <a class="el" href="class__RegisterCache.html#af96b572792fcdffe18c21da9a7e761d0">findAliasEntry()</a>, <a class="el" href="class__RegisterCache.html#a575ddf138de0fc6eb9261b0cdebabcfa">getAlias()</a>, <a class="el" href="AmUtils_8cpp.html#ae864f94b05296af36bd53c6b8628b6cb">long2str()</a>, <a class="el" href="classAmBasicSipDialog.html#a173299c62d08cbb0f02efe443eacebc1">AmBasicSipDialog::reply_error()</a>, and <a class="el" href="AmUtils_8cpp.html#abbdee289e238a8d38fc4b0a462cd6c3f">str2long()</a>.</p>

</div>
</div>
<a class="anchor" id="a68264485d27c5e92b09e117e2cac2955"></a><!-- doxytag: member="_RegisterCache::update" ref="a68264485d27c5e92b09e117e2cac2955" args="(const string &amp;alias, long int reg_expires, const AliasEntry &amp;alias_update)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="class__RegisterCache.html#a68264485d27c5e92b09e117e2cac2955">_RegisterCache::update</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>alias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int&#160;</td>
          <td class="paramname"><em>reg_expires</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structAliasEntry.html">AliasEntry</a> &amp;&#160;</td>
          <td class="paramname"><em>alias_update</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Update contact cache entry and alias map entries.</p>
<p>Note: this function locks and unlocks the contact cache bucket and the alias map bucket.</p>
<p>aor: canonical Address-of-Record uri: Contact-URI alias: </p>

<p>References <a class="el" href="classAorBucket.html#a9c7bd72d52f65afd95ebb9e3e48d0e8c">AorBucket::get()</a>, <a class="el" href="class__RegisterCache.html#a8cb9a545c17afab026a0851511aac4ba">getAliasBucket()</a>, <a class="el" href="class__RegisterCache.html#a4d84b66bbebf27967156a13cab16360a">getAorBucket()</a>, <a class="el" href="class__RegisterCache.html#a74d490a082e61e8d50f3ef0d6a9cf6d5">getContactBucket()</a>, and <a class="el" href="classht__map__bucket.html#a5b81b053762964735a573fc5ac233c2f">ht_map_bucket&lt; Key, Value, ElmtAlloc, ElmtCompare &gt;::insert()</a>.</p>

<p>Referenced by <a class="el" href="class__RegisterCache.html#a442afd251ba4bfb59ce36af5692a506f">saveSingleContact()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="RegisterCache_8h_source.html">RegisterCache.h</a></li>
<li>RegisterCache.cpp</li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
